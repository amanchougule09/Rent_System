{% extends "rent/base.html" %}

{% block title %}Tenant Detail{% endblock %}
{% block navbar_title %}Tenant{% endblock %}

{% block content %}
<div class="form-container">
    <h2>{{ tenant.name }}</h2>

    <p><strong>Mobile:</strong> {{ tenant.mobile }}</p>
    <p><strong>Amount:</strong> ₹{{ tenant.amount }}</p>
    <p><strong>Due Type:</strong> {{ tenant.due_type }}</p>

    {% if tenant.due_type == "fixed" %}
        <p><strong>Due Date:</strong> {{ tenant.due_date|date:"d M Y" }}</p>
    {% else %}
        <p><strong>Due Date:</strong> 30 Days Cycle</p>
    {% endif %}

    <p><strong>Paid:</strong> {{ tenant.paid }}</p>

    <hr>

    <!-- NEW FIELDS FROM YOUR MODEL -->
    <p><strong>Security Deposit:</strong> ₹{{ tenant.security_deposit }}</p>

    <p><strong>Deposit Date:</strong> 
        {{ tenant.security_deposit_date|date:"d M Y" }}
    </p>

    <p><strong>Room Number:</strong> 
        {% if tenant.room_number %}
            {{ tenant.room_number }}
        {% else %}
            -
        {% endif %}
    </p>

    <p><strong>Image:</strong></p>
    <img src="{{ tenant.image }}" alt="Tenant Image" style="width:120px; border-radius:10px;">

    <hr>
    <h3>Rent Payment</h3>

    <p>
        <strong>Status:</strong>
        {% if tenant.paid %}
            <span style="color:green;">Paid</span>
        {% else %}
            <span style="color:red;">Unpaid</span>
        {% endif %}
    </p>

    {% if tenant.payment_date %}
        <p><strong>Paid On:</strong> {{ tenant.payment_date|date:"d M Y" }}</p>
    {% endif %}

    {% if not tenant.paid %}
        <form method="POST" action="{% url 'owners:mark_paid' tenant.id %}">
            {% csrf_token %}
            <button class="add-btn">Mark as Paid</button>
        </form>
    {% else %}
        <form method="POST" action="{% url 'owners:mark_unpaid' tenant.id %}">
            {% csrf_token %}
            <button class="delete-btn">Mark Unpaid (Next Month)</button>
        </form>
    {% endif %}


    <br>
    <button class="submit-btn" id="backBtn">Back</button>
    <button class="delete-btn" id="deleteBtn">Delete Tenant</button>
</div>

{% block scripts %}
<script>
document.getElementById("backBtn").onclick = function() {
    window.location.href = "{% url 'owners:tenant_list' %}";
};

document.getElementById("deleteBtn").onclick = function() {
    if (confirm("Are you sure you want to delete this tenant?")) {
        window.location.href = "{% url 'owners:delete_tenant' tenant.id %}";
    }
};
</script>
{% endblock %}
{% endblock %}
