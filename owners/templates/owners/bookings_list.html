{% extends "rent/base.html" %}
{% load static %}

{% block title %}Booking Management | Rental Manago{% endblock %}

{% block content %}
<div class="page-header-flex">
    <div class="header-left">
        <h1>Booking Management</h1>
        <div class="search-container">
            <input type="text" id="bookingSearch" placeholder="Search by customer or room...">
        </div>
    </div>
</div>

<div class="card-style no-padding">
    <table class="modern-table">
        <thead>
            <tr>
                <th>Booking ID</th>
                <th>Room Details</th>
                <th>Customer Information</th>
                <th>Stay Duration</th>
                <th>Booking Status</th>
                <th class="text-right">Actions</th>
            </tr>
        </thead>
        <tbody id="bookingTableBody">
            {% for b in bookings %}
            <tr>
                <td class="text-muted">#BK-{{ b.id }}</td>
                <td>
                    <div class="room-cell">
                        <strong>{{ b.room.title }}</strong>
                        <p class="text-small">{{ b.room.room_number }}</p>
                    </div>
                </td>
                <td>
                    <div class="user-cell">
                        <div class="avatar-circle-small">{{ b.customer_name|slice:":1" }}</div>
                        <div>
                            <span class="d-block"><strong>{{ b.customer_name }}</strong></span>
                            <span class="text-small">{{ b.customer_email }}</span>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="date-range">
                        <span>{{ b.start_date|date:"M d, Y" }}</span>
                        <i class="fas fa-arrow-right text-muted mx-5"></i>
                        <span>{{ b.end_date|date:"M d, Y" }}</span>
                    </div>
                </td>
                <td>
                    {% if b.status == 'confirmed' %}
                        <span class="badge available">Confirmed</span>
                    {% elif b.status == 'pending' %}
                        <span class="badge warning">Pending</span>
                    {% else %}
                        <span class="badge occupied">Cancelled</span>
                    {% endif %}
                </td>
                <td class="text-right">
                    <div class="action-buttons">
                        <a href="#" class="btn-table-outline">Update Status</a>
                        <a href="#" class="btn-table-outline">View Details</a>
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center py-50">
                    <p class="text-muted">No bookings found for your rooms.</p>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    // Live filter for bookings
    document.getElementById('bookingSearch').addEventListener('keyup', function() {
        let filter = this.value.toLowerCase();
        let rows = document.querySelectorAll('#bookingTableBody tr');
        rows.forEach(row => {
            let text = row.textContent.toLowerCase();
            row.style.display = text.includes(filter) ? '' : 'none';
        });
    });
</script>
{% endblock %}